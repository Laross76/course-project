# План автоматизации тестирования сервиса покупки тура.
## 1. Цель плана
Цель данного плана — описать процесс автоматизации тестирования веб-сервиса покупки тура. Сервис позволяет пользователям приобретать туры с использованием двух методов оплаты: дебетовой картой (через Payment Gate) и в кредит (через Credit Gate). Автоматизация фокусируется на функциональном тестировании, включая взаимодействие с внешними банковскими сервисами, валидацию форм, проверку базы данных (MySQL) и обработку ошибок. Тесты должны обеспечивать покрытие основных сценариев, выявлять регрессии и интегрироваться в CI/CD для регулярного выполнения.

## 1.2. Область тестирования
- Функциональность: Проверка успешных и неудачных покупок, валидация полей формы.
- Интеграция: Взаимодействие с Payment Gate и Credit Gate (банковские сервисы).
- База данных: Проверка статуса платежей в MySQL (поля: payment_id, status, payment_method, amount; данные карт не хранятся).
- UI/UX: Валидация форм оплаты, отображение сообщений об успехе/ошибке.
- Отрицательные сценарии: Отказы карт, невалидные данные.
- Не в области: Производительность, безопасность (кроме базовой валидации), ручное тестирование (фокус на автоматизации).
- Тестовые данные: Используются APPROVED (успешные) и DECLINED (отказы) карты, предоставленные для тестирования. Сумма тура фиксирована (45000 RUB).

## 1.3. Предположения и ограничения
- Доступ к тестовым банковским сервисам (Payment Gate, Credit Gate) и MySQL БД.
- UI формы оплаты стабилен (риск изменений).
- Тесты запускаются в изолированной среде (staging).
- Ограничение: Автоматизация начинается с одного метода оплаты (дебетовая карта), затем расширяется на кредит.
  
## 1. Стратегия тестирования
## 2.1. Типы тестов
- Функциональные: UI-тесты форм, API-тесты взаимодействия с банками, DB-тесты статуса.
- Интеграционные: Проверка потока от формы до БД.
- Негативные: Валидация ошибок.
- Регрессионные: Повторные запуски после изменений. 
  
## 2.2. Приоритезация сценариев
- Высокий приоритет: Happy path (успешные покупки).
- Средний приоритет: Негативные сценарии (отказы карт).
- Низкий приоритет: Валидация полей (эквивалентное разбиение и граничные значения).
  
## 2.3. Критерии завершения
- Покрытие основных сценариев (минимум 80% функциональности).
- Успешный запуск в CI/CD.
- Отчеты Allure без критических багов.
  
## 1. Тестовые сценарии и кейсы
Тестовые сценарии структурированы как чек-лист. Каждый кейс включает название, входные данные, ожидаемые результаты и примечания. Сценарии адаптированы для обеих форм оплаты (карта и кредит), но фокус на дебетовой карте. Методы: эквивалентное разбиение (классы валидных/невалидных значений) и граничные значения (минимум/максимум).

## Общие валидные тестовые данные (для позитивных и базовых негативных сценариев)
Эти данные используются во всех сценариях, где требуется успешная операция. Они соответствуют картам APPROVED (успешные) и DECLINED (отказы). Общая характеристика: данные генерируются на основе реальных шаблонов Visa/Mastercard (номер — 16 цифр, владелец — латиница, срок — будущая дата, CVC — 3 цифры). Конкретные примеры:

- Номер карты APPROVED: 1111 2222 3333 4444.
- Владелец: IVAN IVANOV.
- Месяц срока: 12.
- Год срока: 25 (текущий год + 1).
- CVC: 123.
- Сумма тура: 45000 RUB.
- Для кредита: те же данные, плюс лимит 100000 RUB (одобрен).
  
## Позитивные сценарии (Happy Path)
Эти сценарии проверяют успешное приобретение тура. Включают проверки в БД: статус = "APPROVED", payment_method = "CARD" или "CREDIT", amount = 45000, без хранения данных карты.

## 1.Успешная покупка тура по дебетовой карте (APPROVED)
- Входные данные: Валидные данные (как выше).
- Ожидаемые результаты: Тур куплен, UI: сообщение "Покупка успешна". БД: новая запись с status = "APPROVED", payment_method = "CARD".
- Примечания: Тестируется Payment Gate.
  
## 2.Успешная покупка тура в кредит (APPROVED)
- Входные данные: Валидные данные (как выше).
- Ожидаемые результаты: Тур куплен, UI: сообщение "Кредит одобрен". БД: новая запись с status = "APPROVED", payment_method = "CREDIT".
- Примечания: Тестируется Credit Gate.
  
## Негативные сценарии (Отклонённая карта)
Эти сценарии проверяют отказы. Покупка не совершается. БД: status = "DECLINED", payment_method = "CARD" или "CREDIT".

## 1.Отказ в покупке тура по дебетовой карте (DECLINED)
- Входные данные: Валидный шаблон, номер DECLINED: 5555 6666 7777 8888.
- Ожидаемые результаты: Тур не куплен, UI: "Карта отклонена". БД: новая запись с status = "DECLINED", payment_method = "CARD".
- Примечания: Тестируется Payment Gate.
  
## 2.Отказ в покупке тура в кредит (DECLINED)
- Входные данные: Валидный шаблон, номер DECLINED: 5555 6666 7777 8888.
- Ожидаемые результаты: Тур не куплен, UI: "Кредит отклонен". БД: новая запись с status = "DECLINED", payment_method = "CREDIT".
- Примечания: Тестируется Credit Gate.
  
## Негативные сценарии (Валидация полей формы)
Эти сценарии проверяют невалидные данные по каждому полю (по очереди). Методы: эквивалентное разбиение и граничные значения. Ожидания: Форма не отправляется, UI: ошибка валидации, БД: нет записи (или status = "FAILED" при попытке). Сценарии разделены на под-сценарии для детализации реакции системы на разные типы входных данных. Это обеспечивает более точную логику автотестов и покрытие различных случаев.

## 1.Валидация поля "Номер карты" (невалидный номер)
## 1.1. Валидация поля "Номер карты" - короткий номер (менее 16 цифр)
- Входные данные: "123456789" (9 цифр, граничное значение 15 и менее). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный номер карты" (или специфическая ошибка для короткого номера). БД: нет записи.
- Примечания: Эквивалентное разбиение по длине, граничные значения.
  
## 1.2. Валидация поля "Номер карты" - длинный номер (более 16 цифр)
- Входные данные: "11112222333344445555" (20 цифр, граничное значение 17 и более). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный номер карты" (или специфическая ошибка для длинного номера). БД: нет записи.
- Примечания: Эквивалентное разбиение по длине, граничные значения.
  
## 1.3. Валидация поля "Номер карты" - буквы вместо цифр
- Входные данные: "abcd efgh ijkl mnop" (буквы). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный номер карты" (или специфическая ошибка для букв). БД: нет записи.
- Примечания: Эквивалентное разбиение по типу символов.
  
## 1.4. Валидация поля "Номер карты" - спецсимволы
- Входные данные: "1111-2222-3333-4444" (спецсимволы). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный номер карты" (или специфическая ошибка для спецсимволов). БД: нет записи.
- Примечания: Эквивалентное разбиение по типу символов.
  
## 1.5. Валидация поля "Номер карты" - не из тестового набора (случайный валидный формат)
- Входные данные: "9999 8888 7777 6666" (16 цифр, но не APPROVED/DECLINED). Остальные поля валидны.
- Ожидаемые результаты: Форма может отправиться, но покупка отклонена, UI: "Карта отклонена". БД: новая запись с status = "DECLINED" (если система пытается обработать).
- Примечания: Проверяет реакцию на неизвестные карты; логика теста отличается от чистой валидации формы.
  
## 2.Валидация поля "Владелец" (невалидное имя)
## 2.1. Валидация поля "Владелец" - кириллица
- Входные данные: "Иван Иванов" (кириллица). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверное имя владельца" (или специфическая ошибка для кириллицы). БД: нет записи.
- Примечания: Эквивалентное разбиение по алфавиту.
  
## 2.2. Валидация поля "Владелец" - спецсимволы
- Входные данные: "Ivan@Ivanov" (спецсимволы). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверное имя владельца". БД: нет записи.
- Примечания: Эквивалентное разбиение по типу символов.
  
## 2.3. Валидация поля "Владелец" - цифры
- Входные данные: "12345" (цифры). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверное имя владельца". БД: нет записи.
- Примечания: Эквивалентное разбиение по типу символов.
  
## 2.4. Валидация поля "Владелец" - пустое поле
- Входные данные: "" (пустое). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверное имя владельца" (обязательное поле). БД: нет записи.
- Примечания: Граничные значения по длине (0 символов).
  
## 2.5. Валидация поля "Владелец" - слишком длинное имя
- Входные данные: "Very Long Name That Exceeds Normal Limits For Cardholder" (более 30 символов). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверное имя владельца" (или специфическая ошибка для длины). БД: нет записи.
- Примечания: Граничные значения по длине (31+ символов).
  
## 3.Валидация поля "Месяц срока" (невалидный месяц)
## 3.1. Валидация поля "Месяц срока" - больше 12
- Входные данные: "13" (больше 12). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный месяц срока". БД: нет записи.
- Примечания: Эквивалентное разбиение по диапазону, граничные значения.
  
## 3.2. Валидация поля "Месяц срока" - меньше 01
- Входные данные: "00" (меньше 01). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный месяц срока". БД: нет записи.
- Примечания: Граничные значения.
  
## 3.3. Валидация поля "Месяц срока" - буквы
- Входные данные: "ab" (буквы). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный месяц срока". БД: нет записи.
- Примечания: Эквивалентное разбиение по типу символов.
  
## 3.4. Валидация поля "Месяц срока" - пустое поле
- Входные данные: "" (пустое). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный месяц срока" (обязательное поле). БД: нет записи.
- Примечания: Граничные значения.
  
## 3.5. Валидация поля "Месяц срока" - одна цифра
- Входные данные: "1" (одна цифра, граничное для формата). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный месяц срока" (ожидается 2 цифры). БД: нет записи.
- Примечания: Граничные значения по длине.
  
## 4.Валидация поля "Год срока" (невалидный год)
## 4.1. Валидация поля "Год срока" - прошедший год
- Входные данные: "20" (прошедший). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный год срока". БД: нет записи.
- Примечания: Эквивалентное разбиение по времени, граничные значения (текущий год - 1).
  
## 4.2. Валидация поля "Год срока" - слишком далёкий год
- Входные данные: "35" (далёкий, более 10 лет). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный год срока". БД: нет записи.
- Примечания: Граничные значения (текущий год + 10).
  
## 4.3. Валидация поля "Год срока" - буквы
- Входные данные: "ab" (буквы). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный год срока". БД: нет записи.
- Примечания: Эквивалентное разбиение по типу символов.
  
## 4.4. Валидация поля "Год срока" - пустое поле
- Входные данные: "" (пустое). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный год срока" (обязательное поле). БД: нет записи.
- Примечания: Граничные значения.
  
## 4.5. Валидация поля "Год срока" - одна цифра
- Входные данные: "2" (одна цифра, граничное для формата). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный год срока" (ожидается 2 цифры). БД: нет записи.
- Примечания: Граничные значения по длине.
  
## 5.Валидация поля "CVC" (невалидный CVC)
## 5.1. Валидация поля "CVC" - короткий CVC
- Входные данные: "12" (2 цифры, граничное 2). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный CVC". БД: нет записи.
- Примечания: Эквивалентное разбиение по длине, граничные значения.
  
## 5.2. Валидация поля "CVC" - длинный CVC
- Входные данные: "1234" (4 цифры, граничное 4). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный CVC". БД: нет записи.
- Примечания: Граничные значения.
  
## 5.3. Валидация поля "CVC" - буквы
- Входные данные: "abc" (буквы). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный CVC". БД: нет записи.
- Примечания: Эквивалентное разбиение по типу символов.
  
## 5.4. Валидация поля "CVC" - пустое поле
- Входные данные: "" (пустое). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный CVC" (обязательное поле). БД: нет записи.
- Примечания: Граничные значения.
  
## 5.5. Валидация поля "CVC" - смешанный ввод
- Входные данные: "12a" (смешанный). Остальные поля валидны.
- Ожидаемые результаты: Форма не отправляется, UI: "Неверный CVC". БД: нет записи.
- Примечания: Эквивалентное разбиение по типу символов.
  
## 6.Валидация пустой формы (все поля пустые)
- Входные данные: Все поля пустые ("").
- Ожидаемые результаты: Форма не отправляется, UI: ошибки по всем полям. БД: нет записи.
- Примечания: Комплексный негативный сценарий.
  
## Инструменты и технологии
- Язык программирования: Python (рекомендуется версия 3.8+ для совместимости с библиотеками).
- Фреймворки тестирования: pytest для управления тестами, фикстур и параметризации (легче и гибче, чем JUnit/TestNG в Python-экосистеме).
- UI-автоматизация: Selenium (с WebDriver) для взаимодействия с веб-формами (стандартный выбор для Python; можно добавить selenium-stealth для обхода анти-бот-защиты, если потребуется).
- API-тестирование: requests (с дополнительными библиотеками вроде requests-mock для моков) для проверки запросов к Payment Gate/Credit Gate (простой и мощный HTTP-клиент, заменяет RestAssured).
- База данных: mysql-connector-python для прямых запросов в MySQL БД (проверка статуса платежей).
- Отчетность: Allure с pytest-плагином (pytest-allure-adaptor) для генерации отчетов с скриншотами, логами и историей тестов.
- Версионный контроль: GitHub для хранения кода тестов.
- CI/CD: Jenkins/GitLab CI для автоматического запуска тестов (ежедневно или по коммитам).
- Окружение: Docker для контейнеризации тестов, браузеры Chrome/Firefox (с chromedriver/geckodriver).
  
## Риски и смягчение
- Изменения UI: Мониторинг селекторов; использовать стабильные локаторы.
- Нестабильность банковских сервисов: Мокировать ответы для изоляции.
- Доступ к логам/БД: Обеспечить разрешения; использовать тестовую БД.
- Длительное время выполнения: Оптимизировать тесты, параллельные запуски.
- Внешние зависимости: Тестировать в staging-среде с симуляцией.
  
## Оценка усилий и ресурсов
- Анализ и планирование: 5 часов.
- Написание тестов: 15 часов (по 2-3 часа на сценарий).
- Отладка и интеграция: 3 часа.
- Отчеты и документация: 2 часа.
- Итого: ~25 часов.
- Ресурсы: 1 QA-инженер (автоматизатор), доступ к инструментам.
  
## Процесс выполнения и отчетность
- Разработка: Написать тесты в GitHub-репозитории (публичный для материалов).
- Запуск: В CI/CD, с Allure-отчетами (успех/провал, покрытие).
- Мониторинг: Еженедельные ревью багов, обновление тестов при изменениях.
- Завершение: После успешного прогона и покрытия критериев.